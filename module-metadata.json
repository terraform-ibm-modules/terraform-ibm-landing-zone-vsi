{
  "path": ".",
  "variables": {
    "access_tags": {
      "name": "access_tags",
      "type": "list(string)",
      "description": "A list of access tags to apply to the VSI resources created by the module. For more information, see https://cloud.ibm.com/docs/account?topic=account-access-tags-tutorial.",
      "default": [],
      "source": [
        "ibm_is_floating_ip.secondary_fip.access_tags",
        "ibm_is_floating_ip.vsi_fip.access_tags",
        "ibm_is_instance.vsi.access_tags",
        "ibm_is_lb.lb.access_tags",
        "ibm_is_security_group.security_group.access_tags",
        "ibm_is_volume.volume.access_tags"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 26
      },
      "computed": true,
      "elem": {
        "type": "TypeString"
      }
    },
    "allow_ip_spoofing": {
      "name": "allow_ip_spoofing",
      "type": "bool",
      "description": "Allow IP spoofing on the primary network interface",
      "default": false,
      "pos": {
        "filename": "variables.tf",
        "line": 113
      }
    },
    "block_storage_volumes": {
      "name": "block_storage_volumes",
      "type": "list(\n    object({\n      name              = string\n      profile           = string\n      capacity          = optional(number)\n      iops              = optional(number)\n      encryption_key    = optional(string)\n      resource_group_id = optional(string)\n    })\n  )",
      "description": "List describing the block storage volumes that will be attached to each vsi",
      "default": [],
      "source": [
        "ibm_is_instance.vsi.volumes"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 212
      }
    },
    "boot_volume_encryption_key": {
      "name": "boot_volume_encryption_key",
      "type": "string",
      "description": "CRN of boot volume encryption key",
      "pos": {
        "filename": "variables.tf",
        "line": 95
      }
    },
    "create_security_group": {
      "name": "create_security_group",
      "type": "bool",
      "description": "Create security group for VSI. If this is passed as false, the default will be used",
      "required": true,
      "pos": {
        "filename": "variables.tf",
        "line": 119
      }
    },
    "enable_floating_ip": {
      "name": "enable_floating_ip",
      "type": "bool",
      "description": "Create a floating IP for each virtual server created",
      "default": false,
      "source": [
        "ibm_is_floating_ip.vsi_fip.for_each"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 107
      }
    },
    "existing_kms_instance_guid": {
      "name": "existing_kms_instance_guid",
      "type": "string",
      "description": "The GUID of the Hyper Protect Crypto Services instance in which the key specified in var.boot_volume_encryption_key is coming from.",
      "source": [
        "ibm_iam_authorization_policy.block_storage_policy.target_resource_instance_id"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 101
      },
      "immutable": true,
      "computed": true
    },
    "image_id": {
      "name": "image_id",
      "type": "string",
      "description": "Image ID used for VSI. Run 'ibmcloud is images' to find available images in a region",
      "required": true,
      "source": [
        "ibm_is_instance.vsi.image"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 70
      },
      "immutable": true,
      "computed": true
    },
    "kms_encryption_enabled": {
      "name": "kms_encryption_enabled",
      "type": "bool",
      "description": "Set this to true to control the encryption keys used to encrypt the data that for the block storage volumes for VPC. If set to false, the data is encrypted by using randomly generated keys. For more info on encrypting block storage volumes, see https://cloud.ibm.com/docs/vpc?topic=vpc-creating-instances-byok",
      "default": false,
      "source": [
        "ibm_iam_authorization_policy.block_storage_policy.count"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 200
      }
    },
    "load_balancers": {
      "name": "load_balancers",
      "type": "list(\n    object({\n      name                    = string\n      type                    = string\n      listener_port           = number\n      listener_protocol       = string\n      connection_limit        = number\n      idle_connection_timeout = number\n      algorithm               = string\n      protocol                = string\n      health_delay            = number\n      health_retries          = number\n      health_timeout          = number\n      health_type             = string\n      pool_member_port        = string\n      profile                 = optional(string)\n      dns = optional(\n        object({\n          instance_crn = string\n          zone_id      = string\n        })\n      )\n      security_group = optional(\n        object({\n          name = string\n          rules = list(\n            object({\n              name      = string\n              direction = string\n              source    = string\n              tcp = optional(\n                object({\n                  port_max = number\n                  port_min = number\n                })\n              )\n              udp = optional(\n                object({\n                  port_max = number\n                  port_min = number\n                })\n              )\n              icmp = optional(\n                object({\n                  type = number\n                  code = number\n                })\n              )\n            })\n          )\n        })\n      )\n    })\n  )",
      "description": "Load balancers to add to VSI",
      "default": [],
      "pos": {
        "filename": "variables.tf",
        "line": 232
      }
    },
    "machine_type": {
      "name": "machine_type",
      "type": "string",
      "description": "VSI machine type. Run 'ibmcloud is instance-profiles' to get a list of regional profiles",
      "required": true,
      "source": [
        "ibm_is_instance.vsi.profile"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 80
      },
      "computed": true
    },
    "placement_group_id": {
      "name": "placement_group_id",
      "type": "string",
      "description": "Unique Identifier of the Placement Group for restricting the placement of the instance, default behaviour is placement on any host",
      "source": [
        "ibm_is_instance.vsi.placement_group"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 124
      },
      "immutable": true
    },
    "prefix": {
      "name": "prefix",
      "type": "string",
      "description": "The IBM Cloud platform API key needed to deploy IAM enabled resources",
      "required": true,
      "source": [
        "ibm_is_lb.lb.name",
        "ibm_is_lb_pool.pool.name"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 10
      },
      "min_length": 1,
      "max_length": 63,
      "matches": "^([a-z]|[a-z][-a-z0-9]*[a-z0-9])$"
    },
    "resource_group_id": {
      "name": "resource_group_id",
      "type": "string",
      "description": "ID of resource group to create VSI and block storage volumes. If you wish to create the block storage volumes in a different resource group, you can optionally set that directly in the 'block_storage_volumes' variable.",
      "required": true,
      "source": [
        "ibm_is_instance.vsi.resource_group",
        "ibm_is_lb.lb.resource_group",
        "ibm_is_security_group.security_group.resource_group"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 5
      },
      "cloud_data_type": "resource_group",
      "immutable": true,
      "computed": true
    },
    "secondary_allow_ip_spoofing": {
      "name": "secondary_allow_ip_spoofing",
      "type": "bool",
      "description": "Allow IP spoofing on additional network interfaces",
      "default": false,
      "pos": {
        "filename": "variables.tf",
        "line": 416
      }
    },
    "secondary_floating_ips": {
      "name": "secondary_floating_ips",
      "type": "list(string)",
      "description": "List of secondary interfaces to add floating ips",
      "default": [],
      "source": [
        "ibm_is_floating_ip.secondary_fip.for_each"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 405
      }
    },
    "secondary_security_groups": {
      "name": "secondary_security_groups",
      "type": "list(\n    object({\n      security_group_id = string\n      interface_name    = string\n    })\n  )",
      "description": "The security group IDs to add to the VSI deployment secondary interfaces (5 maximum). Use the same value for interface_name as for name in secondary_subnets to avoid applying the default VPC security group on the secondary network interface.",
      "default": [],
      "pos": {
        "filename": "variables.tf",
        "line": 384
      }
    },
    "secondary_subnets": {
      "name": "secondary_subnets",
      "type": "list(\n    object({\n      name = string\n      id   = string\n      zone = string\n      cidr = optional(string)\n    })\n  )",
      "description": "List of secondary network interfaces to add to vsi secondary subnets must be in the same zone as VSI. This is only recommended for use with a deployment of 1 VSI.",
      "default": [],
      "pos": {
        "filename": "variables.tf",
        "line": 365
      }
    },
    "secondary_use_vsi_security_group": {
      "name": "secondary_use_vsi_security_group",
      "type": "bool",
      "description": "Use the security group created by this module in the secondary interface",
      "default": false,
      "pos": {
        "filename": "variables.tf",
        "line": 378
      }
    },
    "security_group": {
      "name": "security_group",
      "type": "object({\n    name = string\n    rules = list(\n      object({\n        name      = string\n        direction = string\n        source    = string\n        tcp = optional(\n          object({\n            port_max = number\n            port_min = number\n          })\n        )\n        udp = optional(\n          object({\n            port_max = number\n            port_min = number\n          })\n        )\n        icmp = optional(\n          object({\n            type = number\n            code = number\n          })\n        )\n      })\n    )\n  })",
      "description": "Security group created for VSI",
      "pos": {
        "filename": "variables.tf",
        "line": 130
      }
    },
    "security_group_ids": {
      "name": "security_group_ids",
      "type": "list(string)",
      "description": "IDs of additional security groups to be added to VSI deployment primary interface. A VSI interface can have a maximum of 5 security groups.",
      "default": [],
      "pos": {
        "filename": "variables.tf",
        "line": 184
      }
    },
    "skip_iam_authorization_policy": {
      "name": "skip_iam_authorization_policy",
      "type": "bool",
      "description": "Set to true to skip the creation of an IAM authorization policy that permits all Storage Blocks to read the encryption key from the KMS instance. If set to false, pass in a value for the KMS instance in the existing_kms_instance_guid variable. In addition, no policy is created if var.kms_encryption_enabled is set to false.",
      "default": false,
      "pos": {
        "filename": "variables.tf",
        "line": 206
      }
    },
    "ssh_key_ids": {
      "name": "ssh_key_ids",
      "type": "list(string)",
      "description": "ssh key ids to use in creating vsi",
      "required": true,
      "source": [
        "ibm_is_instance.vsi.keys"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 75
      },
      "elem": {
        "type": "TypeString"
      }
    },
    "subnets": {
      "name": "subnets",
      "type": "list(\n    object({\n      name = string\n      id   = string\n      zone = string\n      cidr = optional(string)\n    })\n  )",
      "description": "A list of subnet IDs where VSI will be deployed",
      "required": true,
      "source": [
        "ibm_is_lb.lb.subnets"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 51
      }
    },
    "tags": {
      "name": "tags",
      "type": "list(string)",
      "description": "List of tags to apply to resources created by this module.",
      "default": [],
      "source": [
        "ibm_is_floating_ip.secondary_fip.tags",
        "ibm_is_floating_ip.vsi_fip.tags",
        "ibm_is_instance.vsi.tags",
        "ibm_is_lb.lb.tags",
        "ibm_is_security_group.security_group.tags",
        "ibm_is_volume.volume.tags"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 20
      },
      "min_length": 1,
      "max_length": 128,
      "matches": "^[A-Za-z0-9:_ .-]+$",
      "computed": true,
      "elem": {
        "type": "TypeString"
      }
    },
    "user_data": {
      "name": "user_data",
      "type": "string",
      "description": "User data to initialize VSI deployment",
      "required": true,
      "source": [
        "ibm_is_instance.vsi.user_data"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 90
      },
      "immutable": true
    },
    "vpc_id": {
      "name": "vpc_id",
      "type": "string",
      "description": "ID of VPC",
      "required": true,
      "source": [
        "data.ibm_is_vpc.vpc.identifier",
        "ibm_is_instance.vsi.vpc",
        "ibm_is_security_group.security_group.vpc"
      ],
      "pos": {
        "filename": "variables.tf",
        "line": 46
      },
      "immutable": true,
      "computed": true
    },
    "vsi_per_subnet": {
      "name": "vsi_per_subnet",
      "type": "number",
      "description": "Number of VSI instances for each subnet",
      "required": true,
      "pos": {
        "filename": "variables.tf",
        "line": 85
      }
    }
  },
  "outputs": {
    "fip_list": {
      "name": "fip_list",
      "description": "A list of VSI with name, id, zone, and primary ipv4 address, and floating IP. This list only contains instances with a floating IP attached.",
      "pos": {
        "filename": "outputs.tf",
        "line": 34
      }
    },
    "ids": {
      "name": "ids",
      "description": "The IDs of the VSI",
      "pos": {
        "filename": "outputs.tf",
        "line": 5
      }
    },
    "lb_hostnames": {
      "name": "lb_hostnames",
      "description": "Hostnames for the Load Balancer created",
      "pos": {
        "filename": "outputs.tf",
        "line": 56
      }
    },
    "lb_security_groups": {
      "name": "lb_security_groups",
      "description": "Load Balancer security groups",
      "pos": {
        "filename": "outputs.tf",
        "line": 64
      }
    },
    "list": {
      "name": "list",
      "description": "A list of VSI with name, id, zone, and primary ipv4 address",
      "pos": {
        "filename": "outputs.tf",
        "line": 18
      }
    },
    "vsi_security_group": {
      "name": "vsi_security_group",
      "description": "Security group for the VSI",
      "pos": {
        "filename": "outputs.tf",
        "line": 13
      }
    }
  },
  "required_core": [
    "\u003e= 1.3.0, \u003c1.6.0"
  ],
  "required_providers": {
    "ibm": {
      "source": "IBM-Cloud/ibm",
      "version_constraints": [
        "\u003e= 1.54.0"
      ]
    },
    "time": {
      "source": "hashicorp/time",
      "version_constraints": [
        "\u003e= 0.9.1"
      ]
    }
  },
  "managed_resources": {
    "ibm_iam_authorization_policy.block_storage_policy": {
      "mode": "managed",
      "type": "ibm_iam_authorization_policy",
      "name": "block_storage_policy",
      "attributes": {
        "count": "kms_encryption_enabled",
        "target_resource_instance_id": "existing_kms_instance_guid"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 83
      }
    },
    "ibm_is_floating_ip.secondary_fip": {
      "mode": "managed",
      "type": "ibm_is_floating_ip",
      "name": "secondary_fip",
      "attributes": {
        "access_tags": "access_tags",
        "for_each": "secondary_floating_ips",
        "tags": "tags"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 170
      }
    },
    "ibm_is_floating_ip.vsi_fip": {
      "mode": "managed",
      "type": "ibm_is_floating_ip",
      "name": "vsi_fip",
      "attributes": {
        "access_tags": "access_tags",
        "for_each": "enable_floating_ip",
        "tags": "tags"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 162
      }
    },
    "ibm_is_instance.vsi": {
      "mode": "managed",
      "type": "ibm_is_instance",
      "name": "vsi",
      "attributes": {
        "access_tags": "access_tags",
        "image": "image_id",
        "keys": "ssh_key_ids",
        "placement_group": "placement_group_id",
        "profile": "machine_type",
        "resource_group": "resource_group_id",
        "tags": "tags",
        "user_data": "user_data",
        "volumes": "block_storage_volumes",
        "vpc": "vpc_id"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 92
      }
    },
    "ibm_is_lb.lb": {
      "mode": "managed",
      "type": "ibm_is_lb",
      "name": "lb",
      "attributes": {
        "access_tags": "access_tags",
        "name": "prefix",
        "resource_group": "resource_group_id",
        "subnets": "subnets",
        "tags": "tags"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "load_balancer.tf",
        "line": 12
      }
    },
    "ibm_is_lb_listener.listener": {
      "mode": "managed",
      "type": "ibm_is_lb_listener",
      "name": "listener",
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "load_balancer.tf",
        "line": 82
      }
    },
    "ibm_is_lb_pool.pool": {
      "mode": "managed",
      "type": "ibm_is_lb_pool",
      "name": "pool",
      "attributes": {
        "name": "prefix"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "load_balancer.tf",
        "line": 31
      }
    },
    "ibm_is_lb_pool_member.pool_members": {
      "mode": "managed",
      "type": "ibm_is_lb_pool_member",
      "name": "pool_members",
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "load_balancer.tf",
        "line": 66
      }
    },
    "ibm_is_security_group.security_group": {
      "mode": "managed",
      "type": "ibm_is_security_group",
      "name": "security_group",
      "attributes": {
        "access_tags": "access_tags",
        "resource_group": "resource_group_id",
        "tags": "tags",
        "vpc": "vpc_id"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "security_group.tf",
        "line": 32
      }
    },
    "ibm_is_security_group_rule.security_group_rules": {
      "mode": "managed",
      "type": "ibm_is_security_group_rule",
      "name": "security_group_rules",
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "security_group.tf",
        "line": 67
      }
    },
    "ibm_is_volume.volume": {
      "mode": "managed",
      "type": "ibm_is_volume",
      "name": "volume",
      "attributes": {
        "access_tags": "access_tags",
        "tags": "tags"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "storage.tf",
        "line": 43
      }
    },
    "time_sleep.wait_for_authorization_policy": {
      "mode": "managed",
      "type": "time_sleep",
      "name": "wait_for_authorization_policy",
      "provider": {
        "name": "time"
      },
      "pos": {
        "filename": "main.tf",
        "line": 62
      }
    }
  },
  "data_resources": {
    "data.ibm_is_vpc.vpc": {
      "mode": "data",
      "type": "ibm_is_vpc",
      "name": "vpc",
      "attributes": {
        "identifier": "vpc_id"
      },
      "provider": {
        "name": "ibm"
      },
      "pos": {
        "filename": "main.tf",
        "line": 72
      }
    }
  },
  "module_calls": {}
}
